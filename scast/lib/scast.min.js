var SCAST=function(){var e={num:!1,kw:!1,id:!1,str:!1,punc:!1,sp:!1,op:!1,Comment:!1,ClassDefine:!0,InterfaceDefine:!0,NamespaceDefine:!0,MethodDefine:!0,PropertyDefine:!0,Variable:!0,NewExpression:!0,CallExpression:!0,FunctionDefine:!0,LoopStatement:!0,IfStatement:!0,BlockStatement:!0,Expression:!1,Condition:!1,Arguments:!1,Arg:!1};function o(e){var o,n=null,t=" break do in typeof case else instanceof var catch export new void class extends return while const finally super with continue for switch yield debugger function this default if throw delete import try constructor super",l=" abstract as base bool break byte case catch char checked class const continue decimal default delegate do double else enum event explicit extern false finally fixed float for foreach goto if implicit in int interface internal is lock long namespace new null object operator out override params private protected public readonly ref return sbyte sealed short sizeof stackalloc static string struct switch this throw true try typeof uint ulong unchecked unsafe ushort using virtual void volatile while  add and alias ascending args async await by descending dynamic equals from get global group init into join let nameof nint not notnull nuint on or orderby partial partial record remove select set unmanaged value var when where with yield";return{next:function(){var e=n;return n=null,e||d()},peek:v,eof:function(){return null==v()},croak:e.croak};function i(e){return/[0-9]/i.test(e)}function a(e){return/[a-zA-Z$_]/i.test(e)}function r(e){return a(e)||"0123456789".indexOf(e)>=0}function u(e){return"+-*/%=&|<>!^\\".indexOf(e)>=0}function s(e){return" \t\n".indexOf(e)>=0}function f(o){for(var n="";!e.eof()&&o(e.peek());)n+=e.next();return n}function p(o){var n=!1,t="";for(e.next();!e.eof();){var l=e.next();if(n)t+=l,n=!1;else if("\\"==l)n=!0;else{if(l==o)break;t+=l}}return t}function c(n){return{type:"str",value:p(n),poi:{line:o.line,start:o.column,end:e.poi().column}}}function d(){if(f(s),e.eof())return null;var n,p,d,v,_=e.peek();return o=e.poi(),"#"==_||"/"==_&&"/"==e.peek(1)?{type:"Comment",value:f((function(e){return"\n"!=e})),poi:{line:o.line,start:o.column,end:e.poi().column}}:'"'==_?c('"'):"'"==_?c("'"):"`"==_?c("`"):i(_)?(n=!1,p=f((function(e){return"."==e?!n&&(n=!0,!0):i(e)})),{type:"num",value:parseFloat(p),poi:{line:o.line,start:o.column,end:e.poi().column}}):a(_)?(v=f(r),{type:(d=v,t.indexOf(" "+d+" ")>=0||l.indexOf(" "+d+" ")>=0?"kw":"id"),value:v,poi:{line:o.line,start:o.column,end:e.poi().column}}):function(e){return"(){}[]".indexOf(e)>=0}(_)?{type:"punc",value:e.next(),poi:{line:o.line,start:o.column,end:e.poi().column}}:function(e){return",;.:?".indexOf(e)>=0}(_)?{type:"sp",value:e.next(),poi:{line:o.line,start:o.column,end:e.poi().column}}:u(_)?{type:"op",value:f(u),poi:{line:o.line,start:o.column,end:e.poi().column}}:void e.croak(`Can't handle character :${_}(${_.charCodeAt(0)})`)}function v(){return n||(n=d())}}function n(e){return function(){var o=[];for(;!e.eof();)o.push(w());return{type:"top",body:o}}();function o(o){var n=e.peek();return n&&"punc"==n.type&&(!o||n.value==o)&&n}function n(o){var n=e.peek();return n&&"sp"==n.type&&(!o||n.value==o)&&n}function t(o){var n=e.peek();return n&&"kw"==n.type&&(!o||n.value==o)&&n}function l(o){var n=e.peek();return n&&"op"==n.type&&(!o||n.value==o)&&n}function i(){return"id"==e.peek().type}function a(n){o(n)?e.next():e.croak('Expecting punctuation: "'+n+'"')}function u(){var n={line:e.peek().poi.line,start:e.peek().poi.start},t=[];for(a("{");!o("}");){var l=w();l&&t.push(l)}return a("}"),{type:"BlockStatement",body:t,poi:n}}function s(){var n={type:"Arguments",body:[],poi:{line:e.peek().poi.line,start:e.peek().poi.start},value:""};for(a("(");!o(")");){var t=f();t&&(n.value+=t.value+" ",n.body.push(t))}return a(")"),n}function f(){if(n(","))return void(n(l=",")?e.next():e.croak('Expecting punctuation: "'+l+'"'));var l;if(o("{"))return u();let a=null;if(i()){if(a=e.next(),o("("))return{type:"CallExpression",value:a.value,poi:{line:a.poi.line,start:a.poi.start},body:[s()]}}else if(t("function")){if(a=e.next(),o("("))return{type:"CallExpression",value:a.value,poi:{line:a.poi.line,start:a.poi.start},body:[s()]}}else a=e.next();return{type:"Arg",value:a.value,node:a,poi:a.poi}}function p(){var n={type:"Condition",poi:{line:e.peek().poi.line,start:e.peek().poi.start},value:"",body:[]};for(a("(");!o(")");){let t=null;i()?(n.value+=e.peek().value+" ",t=e.next(),o("(")&&n.body.push({type:"CallExpression",value:t.value,poi:{line:t.poi.line,start:t.poi.start},body:[s()]})):(t=e.next(),n.value+=t.value+" ",n.body.push(t))}return a(")"),n}function c(){let t=[];for(var a={type:"Expression",poi:{line:e.peek().poi.line,start:e.peek().poi.start}};"num"==e.peek().type||"str"==e.peek().type||l()||n()||o("(")||o(")")||i();){let n=e.peek(),l=e.next();if("id"==n.type&&o("(")?t.push({type:"CallExpression",value:l.value,poi:{line:l.poi.line,start:l.poi.start},body:[s()]}):t.push(l),e.eof())break}return a.body=t,a}function d(n){e.next();if(t("new"))return v();if(t("function")){var l=e.next(),i={type:"FunctionDefine",value:n,poi:{line:l.poi.line,start:l.poi.start}};return o("(")&&(i.arguments=s()),o("{")&&(i.body=[u()]),console.log(i),i}return o("{")?u():c()}function v(){var t=e.next();if(i()){var l={type:"NewExpression",value:e.peek().value,poi:{line:t.poi.line,start:t.poi.start}},a=e.next();return o("(")?(l.body=[s()],l):"<"==e.peek().value?(l.T=e.next(),l):n(".")?v():o("{")?(l.block=u(),l):a}return console.warn("parse new",e.peek()),t}function _(){return o("(")?s():o("{")?u():t("new")?v():i()?function(){var n=e.next();if(o("(")){var t={type:"CallExpression",value:n.value,poi:{line:n.poi.line,start:n.poi.start},body:[s()]};return o("{")&&(t.type="FunctionDefine",t.body=u().body),t}return l("=")?t={type:"Variable",value:n.value,poi:{line:n.poi.line,start:n.poi.start},body:[d(n.value)]}:n}():e.next()}function w(){try{if(!o(";"))return(w=e.peek())&&"kw"==w.type&&(!v&&" public private protected sealed internal static class interface namespace ".indexOf(" "+w.value+" ")>=0||w.value==v)&&w?function(){for(var i={type:"",level:e.peek().value,is_sp:!1,ids:[],return_type:null,value:null,nodes:[],poi:{start:e.peek().poi.start,line:e.peek().poi.line}};!(o("(")||o("{")||l("=")||n(";"));){i.nodes.push(e.peek()),n(":")||t("extends")||t("implements")?i.is_sp=!0:t("class")?i.type="ClassDefine":t("interface")?i.type="InterfaceDefine":t("namespace")?i.type="NamespaceDefine":t("void")&&(i.return_type="void");var a=e.next();"id"==a.type&&i.ids.push(a.value)}return o("(")?(i.type="MethodDefine",i.value=i.ids.slice(-1)[0],i.return_type||(i.return_type=i.ids[0]),i.parameter=s(),n(":")&&(e.next(),i.base=e.peek(),e.next(),o("(")&&(i.base.parameter=s())),o("{")&&(i.body=u().body)):"ClassDefine"==i.type||"InterfaceDefine"==i.type||"NamespaceDefine"==i.type?(i.value=i.ids[0],i.is_sp&&(i.extends=i.ids.slice(1)),o("{")&&(i.body=u().body)):i.type||(i.type="PropertyDefine",i.value=i.ids.slice(-1)[0],l("=")&&(i.body=[d(i.value)])),i}():t("for")||t("while")||t("foreach")?(f=e.next(),o("(")?(r={type:"LoopStatement",value:f.value,poi:{line:f.poi.line,start:f.poi.start},condition:p()},o("{")&&(r.body=u().body),r):(console.warn("parse loop",e.peek()),f)):t("if")||t("else")||t("switch")?function(){var n=e.next(),l={type:"IfStatement",poi:{line:n.poi.line,start:n.poi.start},value:n.value};return t("if")&&(l.value="elif",e.next()),o("(")?(l.condition=p(),o("{")?(l.body=u().body,l):(l.body=[c()],l)):(o("{")&&(l.body=u().body),l)}():_();a(";")}catch(o){var i=e.peek();console.warn(`parse statement ${i.type} ${i.value} at ${i.poi.line}:${i.poi.start}:${i.poi.end}`,o)}var f,v,w}}var t={scastops:e,fontsize:14};return{getAst:function(e){return n(o(function(e){var o=0,n=1,t=0;return{next:function(){var l=e.charAt(o++);return"\n"==l?(n++,t=0):t++,l},peek:l,eof:function(){return""==l()},croak:function(e){throw new Error(e+" ("+n+":"+t+")")},poi:function(){return{line:n,column:t,pos:o}}};function l(n=0){return e.charAt(o+n)}}(e)))},traverseAst:function e(o,n){if(n&&n(o),o.body&&o.body.length>0)for(let t of o.body)e(t,n)},analysisMermaid:function(e,o,n){switch(e.type){case"ClassDefine":if(!n.showMethod)break;if(!1===n.FlowFilter[e.value])break;n.Flow+=`    ${e.value}[${e.value}]\nclick ${e.value} "javascript:void(onFlowClick('${e.value}','${o}'))"\n`,n.FDPNode[e.value]={id:e.value,w:e.value.length*t.fontsize/1.6+2*t.fontsize,text:`[${e.value}]`},l(e,o);break;case"InterfaceDefine":if(!n.showMethod)break;if(!1===n.FlowFilter[e.value])break;n.Flow+=`    ${e.value}{{${e.value}}}\nclick ${e.value} "javascript:void(onFlowClick('${e.value}','${o}'))"\n`,n.FDPNode[e.value]={id:e.value,w:e.value.length*t.fontsize/1.6+2*t.fontsize,text:`{${e.value}}`},l(e,o);break;case"NamespaceDefine":if(!n.showMethod)break;if(!n.showNamespace)break;namespace?n.Flow+=`  end\n  subgraph ${e.value}.namespace\n`:(n.Flow+=`  subgraph ${e.value}.namespace\n`,namespace=e.value);break;case"FunctionDefine":case"MethodDefine":if(n.showMethod)break;a(e,{},o);break;case"Variable":if(n.showMethod)break;r(e,{})}function l(e,o){e._file=o,n.FlowNode[e.value]=e,n.FlowOne[e.value]=e.value,n.UMLClass[e.value]={};var l={public:"+",private:"-",protected:"#",internal:"~",static:"$"};n.UML+=`  class ${e.value}{\n`;for(let n of e.body){let t=n.level&&l[n.level]?l[n.level]:" ";switch(n.type){case"PropertyDefine":i(n,e,o,t);break;case"MethodDefine":case"FunctionDefine":a(n,e,o,t)}}if(n.UML+="  }\n",e.extends)for(let o of e.extends)n.FlowNode[o]&&"InterfaceDefine"==n.FlowNode[o].type?(n.FDPNode[o]={id:o,w:o.length*t.fontsize/1.6+2*t.fontsize,text:`{${o}}`},n.UML+=`  ${o} <|.. ${e.value}\n`,n.FlowLink+=`${o} ==> ${e.value}\n`,n.FDPLinks.push({source:e.value,target:o,value:6,dist:200,dash:"2,2"})):(void 0===n.FDPNode[o]&&(n.FDPNode[o]={id:o,w:o.length*t.fontsize/1.6+2*t.fontsize,text:`[${o}]`}),n.UML+=`  ${o} <|-- ${e.value}\n`,n.FlowLink+=`${o} ==o ${e.value}\n`,n.FDPLinks.push({source:o,target:e.value,value:6,dist:200,dash:"2,2"}))}function i(e,o,l,i){e._flow_id=e.value+"_"+o.value,e._flow_from=o.value,e._flow_prop=`|${i}${e.value.replaceAll("|","|").replaceAll("[","").replaceAll("]","")}|`,e._file=l,!1!==n.FlowFilter[e._flow_id]&&(n.FlowNode[e._flow_id]=e,n.UML+=`    ${i}${e.value}\n`,n.showCall&&function e(l,i){if(!l.body)return;for(let a of l.body)a._file=i,a._flow_id=a.value+"_"+l._flow_id,a._flow_from=l._flow_from,a._flow_prop=l._flow_prop,n.FlowNode[a._flow_id]=a,"Expression"==a.type?(a._flow_id=l._flow_id,e(a,i)):!n.FlowFilter[a._flow_id]||"NewExpression"!=a.type&&"CallExpression"!=a.type||("NewExpression"==a.type?(n.UMLClass[o.value][a._flow_id]=a,a._flow_str=`        ${a._flow_id}[${a.value}]\nclick ${a._flow_id} "javascript:void(onFlowClick('${a._flow_id}','${i}'))"\n`,n.FDPNode[a._flow_id]={id:a._flow_id,w:a.value.length*t.fontsize/1.6,text:`${a.value}`}):(a._flow_str=`        ${a._flow_id}([${a.value}])\nclick ${a._flow_id} "javascript:void(onFlowClick('${a._flow_id}','${i}'))"\n`,n.FDPNode[a._flow_id]={id:a._flow_id,w:a.value.length*t.fontsize/1.6+2*t.fontsize,text:`${a.value}()`}),n.Flow+=a._flow_str)}(e,l))}function a(e,o,l,i){var a=o.value?e.value+"_"+o.value:e.value;n.FlowOne[e.value]=a,e._flow_id=a,e._flow_from=o.value,e._file=l,!1!==n.FlowFilter[e._flow_id]&&(n.FlowNode[e._flow_id]=e,n.FDPNode[e._flow_id]={id:e._flow_id,w:e.value.length*t.fontsize/1.6+3*t.fontsize,text:`${i||":"}${e.value}()`},i&&(n.UML+=`    ${i}${e.value}()\n`),e.base||e.value==o.value?n.Flow+=`    ${e._flow_id}(${e.value})\nclick ${e._flow_id} "javascript:void(onFlowClick('${e._flow_id}','${l}'))"\n`:n.Flow+=`    ${e._flow_id}([${e.value}])\nclick ${e._flow_id} "javascript:void(onFlowClick('${e._flow_id}','${l}'))"\n`,o.value&&(n.FlowLink+=`${o.value} --o ${e._flow_id}\n`,n.FDPLinks.push({source:o.value,target:e._flow_id,value:2})),n.showCall&&function e(l,i){if(!l.body)return;for(let u of l.body)u._file=i,u._flow_id=u.value+"_"+l._flow_id,u._flow_from=n.showIf?l._flow_id:a,n.FlowNode[u._flow_id]=u,"IfStatement"==u.type||"LoopStatement"==u.type?(n.showIf&&(n.Flow+="IfStatement"==u.type?`        ${u._flow_id}{${u.value}}\nclick ${u._flow_id} "javascript:void(onFlowClick('${u._flow_id}','${i}'))"\n`:`        ${u._flow_id}((${u.value}))\nclick ${u._flow_id} "javascript:void(onFlowClick('${u._flow_id}','${i}'))"\n`,n.FDPNode[u._flow_id]={id:u._flow_id,w:0,text:"IfStatement"==u.type?"🔷":"🔵"}),u.condition&&u.condition.value&&(u._flow_condition="|"+u.condition.value.replaceAll("|","｜").replaceAll("[","⌈").replaceAll("]","⌋")+"|"),e(u,i)):!n.FlowFilter[u._flow_id]||"NewExpression"!=u.type&&"CallExpression"!=u.type?"Expression"==u.type?(u._flow_id=l._flow_id,e(u,i)):"Variable"==u.type&&(u._flow_id=l._flow_id,n.showMethod?e(u,i):r(u,i)):("NewExpression"==u.type?(o.value&&(n.UMLClass[o.value][u._flow_id]=u),u._flow_str=`        ${u._flow_id}[${u.value}]\nclick ${u._flow_id} "javascript:void(onFlowClick('${u._flow_id}','${i}'))"\n`,n.FDPNode[u._flow_id]={id:u._flow_id,w:u.value.length*t.fontsize/1.6,text:u.value}):(u._flow_str=`        ${u._flow_id}([${u.value}])\nclick ${u._flow_id} "javascript:void(onFlowClick('${u._flow_id}','${i}'))"\n`,n.FDPNode[u._flow_id]={id:u._flow_id,w:u.value.length*t.fontsize/1.6+2*t.fontsize,text:u.value+"()"}),n.Flow+=u._flow_str)}(e,l))}function r(e,o){n.showMethod||function e(o,l){if(!o.body)return;for(let i of o.body)i._file=l,i._flow_id=i.value+"_"+o._flow_id,i._flow_from=o._flow_id,n.FlowNode[i._flow_id]||(n.FlowNode[i._flow_id]=i,!n.FlowFilter[i._flow_id]||"NewExpression"!=i.type&&"CallExpression"!=i.type?"Expression"==i.type&&(i._flow_id=o._flow_id,e(i,l)):("NewExpression"==i.type?(i._flow_str=`        ${i._flow_id}[${i.value}]\nclick ${i._flow_id} "javascript:void(onFlowClick('${i._flow_id}','${l}'))"\n`,n.FDPNode[i._flow_id]={id:i._flow_id,w:i.value.length*t.fontsize/1.6,text:i.value}):(i._flow_str=`        ${i._flow_id}([${i.value}])\nclick ${i._flow_id} "javascript:void(onFlowClick('${i._flow_id}','${l}'))"\n`,n.FDPNode[i._flow_id]={id:i._flow_id,w:i.value.length*t.fontsize/1.6+2*t.fontsize,text:i.value+"()"}),n.Flow+=i._flow_str))}(e,o)}},analysisD3:function(e,o){if(e.children=[],e.body&&e.body.length>0)for(let o of e.body)(t.scastops[o.type]||t.scastops.all)&&e.children.push(o);switch(e.type){case"top":e.name=o,e.value=o;break;case"ClassDefine":e.name=`[ ${e.value} ]`;break;case"InterfaceDefine":e.name=`( ${e.value} )`;break;case"MethodDefine":e.level&&level_symbol[e.level]?e.name=`${level_symbol[e.level]}${e.value}()`:e.name=`:${e.value}()`;break;case"FunctionDefine":e.name=`:${e.value}()`;break;case"PropertyDefine":e.level&&level_symbol[e.level]?e.name=`${level_symbol[e.level]}${e.value}`:e.name=`${e.value}`;break;case"NamespaceDefine":e.name=e.value+".namespace";break;case"NewExpression":e.name="( "+e.value+" )";break;case"CallExpression":e.name=e.value+"()";break;default:e.name=e.value}},types:e,setD3Config:function(e){t=e}}}();